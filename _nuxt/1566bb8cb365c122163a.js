(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{302:function(t,e,n){"use strict";n.r(e);n(75);var o=n(156),r=n.n(o),l={name:"content-subscriptions",data:function(){return{payment:{stripe:null,clientSecret:"pk_test_Dzl7yTz2o6HP1UYa4Wb4ZC8g00tZaM2vr5",card:null,cardError:"error",status:"ready",plan:null,token:null,email:null},dashboard:{email:null,token:null}}},computed:{isComplete:function(){return this.payment.plan&&this.payment.email&&this.payment.token&&this.payment.token.length>=4&&!this.payment.cardError&&!this.paymentComplete},isProcessing:function(){return"ready"!==this.payment.status&&"complete"!==this.payment.status},paymentComplete:function(){return"complete"===this.payment.status}},mounted:function(){this.initializeStripe(),this.initializeToken()},methods:{managementDashboardLogin:function(t){var e=this;t.preventDefault();var button="#"+t.currentTarget.id;r.a.post("https://test-api.zurianalytics.com//payment/manage",{email:this.dashboard.email,token:this.dashboard.token}).then((function(t){console.dir("Management Dashboard Session returned: ",t.data),window.location.replace(t.data)})).catch((function(t){console.dir("Management Dashboard Session failed:: ",t),e.openTooltip(t.response.data.message,button),e.payment.status="ready"}))},initiatePaymentRequest:function(t){t.preventDefault(),this.payment.status="processing";var e=this;this.submitToStripe().then(e.submitToServer.bind(this)).catch((function(t){e.openTooltip(t.response.data.message),e.payment.status="ready"}))},submitToServer:function(t){var e=this;r.a.post("https://test-api.zurianalytics.com//payment/subscribe",{plan:this.payment.plan,token:this.payment.token,email:this.payment.email,paymentMethodId:t.paymentMethod.id}).then((function(t){console.dir("Subscription returned: ",t.data),"active"===t.data.status?(e.openTooltip("Your payment has been successful! Additional time & calls has been loaded to your api token! Call the token API for additional information!","#subscribe","mild"),e.payment.status="complete"):"incomplete"===t.data.status&&e.submitToStripeConfirmPayment(t.data.latest_invoice.payment_intent.client_secret)})).catch((function(t){console.dir("Subscription failed: ",t),e.openTooltip(t.response.data.message),e.payment.status="ready"}))},submitToStripeConfirmPayment:function(t){var e=this;console.dir("Status incomplete, verifying payment ..."),this.payment.stripe.confirmCardPayment(t).then((function(t){t.error?(t.error&&t.error.message?e.openTooltip(t.error.message):e.openTooltip("Subscription failed for mysterious reasons."),e.payment.status="ready"):(e.openTooltip("Your payment has been successful! Additional time & calls has been loaded to your api token! Call the token API for additional information!","#subscribe","mild"),e.payment.status="complete")}))},submitToStripe:function(){return this.payment.stripe.createPaymentMethod({type:"card",card:this.payment.card})},displayCardErrors:function(t){t.error?(this.payment.cardError=t.error,this.openTooltip(t.error.message,"#card-element")):this.payment.cardError=null},initializeStripe:function(){this.payment.stripe=Stripe(this.payment.clientSecret);var t=this.payment.stripe.elements();this.payment.card=t.create("card",{style:{base:{color:"#32325d",fontSize:"16px"}}}),this.payment.card.on("change",this.displayCardErrors.bind(this)),this.payment.card.mount("#card-element")},initializeToken:function(){var t=this;return r.a.get("https://test-api.zurianalytics.com//token/").then((function(e){return t.payment.token=e.data}))}}},d=n(19),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container-fluid"},[n("h1",{attrs:{id:"subscriptions"}},[t._v("Subscriptions")]),t._v(" "),n("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:function(e,n){return t.visibilityChanged(e,n,"subscriptions")},expression:"(isVisible, entry) => visibilityChanged(isVisible, entry, 'subscriptions')"}],staticClass:"row"},[n("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:function(e,n){return t.visibilityChanged(e,n,"subscription-plans")},expression:"(isVisible, entry) => visibilityChanged(isVisible, entry, 'subscription-plans')"}],staticClass:"col-md-12"},[n("h2",{attrs:{id:"subscription-plans"}},[t._v("Subscription Plans ")]),t._v(" "),n("form",{attrs:{id:"payment-form"}},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-6"},[t._m(0),t._v(" "),n("div",{staticClass:"form-group"},[t._m(1),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.payment.token,expression:"payment.token"}],attrs:{readonly:"readonly",id:"api-token"},domProps:{value:t.payment.token},on:{input:function(e){e.target.composing||t.$set(t.payment,"token",e.target.value)}}})])]),t._v(" "),n("div",{staticClass:"col-md-6"},[n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"plan"}},[t._v("\n                                Select Plan\n                            ")]),t._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:t.payment.plan,expression:"payment.plan"}],attrs:{id:"plan",selected:"individual"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.payment,"plan",e.target.multiple?n:n[0])}}},[n("option",{attrs:{value:"individual"}},[t._v("Individual")]),t._v(" "),n("option",{attrs:{value:"business"}},[t._v("Business")])])]),t._v(" "),n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"email"}},[t._v("\n                                Email Address\n                            ")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.payment.email,expression:"payment.email"}],staticClass:"form-control",attrs:{type:"email",id:"email",placeholder:"Enter email"},domProps:{value:t.payment.email},on:{input:function(e){e.target.composing||t.$set(t.payment,"email",e.target.value)}}})])])]),t._v(" "),n("button",{class:{success:t.paymentComplete},attrs:{disabled:!t.isComplete||t.isProcessing||t.paymentComplete,id:"subscribe"},on:{click:t.initiatePaymentRequest}},[n("span",[t._v("Subscribe")]),t.paymentComplete?n("span",[t._v("d")]):t._e(),t._v(" "),t.isProcessing?n("img",{attrs:{src:"images/loading.svg"}}):t._e()])])])]),t._v(" "),n("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:function(e,n){return t.visibilityChanged(e,n,"manage-subscription")},expression:"(isVisible, entry) => visibilityChanged(isVisible, entry, 'manage-subscription')"}],staticClass:"row"},[n("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:function(e,n){return t.visibilityChanged(e,n,"manage-subscription")},expression:"(isVisible, entry) => visibilityChanged(isVisible, entry, 'manage-subscription')"}],staticClass:"col-md-6"},[n("h2",{attrs:{id:"manage-subscription"}},[t._v("Manage Subscription")]),t._v(" "),n("p",[t._v("\n                You can manage your subscription by adding time / changing payment methods / cancelling\n                subscriptions, etc, by\n                logging in with your token and email address.\n            ")]),t._v(" "),n("form",{attrs:{method:"GET",id:"manage-subscription"}},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-6"},[n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"email"}},[t._v("\n                                Email Address\n                            ")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.dashboard.email,expression:"dashboard.email"}],staticClass:"form-control",attrs:{type:"email",id:"email",placeholder:"Enter email"},domProps:{value:t.dashboard.email},on:{input:function(e){e.target.composing||t.$set(t.dashboard,"email",e.target.value)}}})]),t._v(" "),n("div",{staticClass:"form-group"},[t._m(2),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.dashboard.token,expression:"dashboard.token"}],attrs:{id:"api-token"},domProps:{value:t.dashboard.token},on:{input:function(e){e.target.composing||t.$set(t.dashboard,"token",e.target.value)}}})])])]),t._v(" "),n("button",{attrs:{disabled:!t.dashboard.email||!t.dashboard.token,id:"management-portal"},on:{click:t.managementDashboardLogin}},[n("span",[t._v("Manage Subscription")])])])])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"card-element"}},[this._v("\n                                Credit or debit card\n                            ")]),this._v(" "),e("div",{attrs:{id:"card-element"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",{attrs:{for:"api-token"}},[e("span",{staticClass:"info",attrs:{"data-tippy-content":"The API token is used to authenticate & track all API calls.\n          A token can be reused and additional calls and time will be added to the token automatically with the subscription.\n          The API token must be kept safe and secret.\n          The only restriction of the token is for it to be between 4 and 240 characters."}},[this._v("API Token ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",{attrs:{for:"api-token"}},[e("span",{staticClass:"info",attrs:{"data-tippy-content":"The API token is used to authenticate & track all API calls.\n          A token can be reused and additional calls and time will be added to the token automatically with the subscription.\n          The API token must be kept safe and secret.\n          The only restriction of the token is for it to be between 4 and 240 characters."}},[this._v("API Token ")])])}],!1,null,"3895c83e",null);e.default=component.exports}}]);